/*!
 * Copyright (c) 2017 NAVER corp
 * @egjs/infinitegrid projects are licensed under the MIT <https://naver.github.io/egjs/license.txt> license
 * 
 * @egjs/infinitegrid JavaScript library
 * https://github.com/naver/egjs-infinitegrid
 * 
 * @version 2.0.0-rc.1
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("@egjs/component")):"function"==typeof define&&define.amd?define("InfiniteGrid",["@egjs/component"],e):"object"==typeof exports?exports.InfiniteGrid=e(require("@egjs/component")):(t.eg=t.eg||{},t.eg.InfiniteGrid=e(t.eg.Component))}(this,function(t){return function(t){function __webpack_require__(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,__webpack_require__),n.l=!0,n.exports}var e={};return __webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.i=function(t){return t},__webpack_require__.d=function(t,e,i){__webpack_require__.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},__webpack_require__.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return __webpack_require__.d(e,"a",e),e},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=7)}([function(t,e,i){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e.utils=e.Mixin=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=i(1),r=!!("getComputedStyle"in o.window),s=!!("addEventListener"in o.document),a=function(){var t=!1;try{s&&Object.defineProperty&&o.document.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){t=!0}}))}catch(t){}return t}(),u={$:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=void 0;if("string"==typeof t){if(t.match(/^<([a-z]+)\s*([^>]*)>/)){var n=o.document.createElement("div");n.innerHTML=t,i=Array.prototype.slice.call(n.childNodes)}else i=Array.prototype.slice.call(o.document.querySelectorAll(t));e||(i=i.length>=1?i[0]:void 0)}else t.nodeName&&1===t.nodeType?i=t:o.window.jQuery&&t instanceof jQuery?i=e?t.toArray():t.get(0):Array.isArray(t)&&(i=t.map(function(t){return u.$(t)}),e||(i=i.length>=1?i[0]:void 0));return i},addEvent:function(t,e,i,o){if(s){var r=o||!1;"object"===(void 0===o?"undefined":n(o))&&(r=!!a&&o),t.addEventListener(e,i,r)}else t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i},removeEvent:function(t,e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=null},scrollTop:function(){return o.document.body.scrollTop||o.document.documentElement.scrollTop},getSize:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t===o.window)return t.document.documentElement["client"+e];if(9===t.nodeType){var s=t.documentElement;return Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])}var a=r?o.window.getComputedStyle(t):t.currentStyle,u="Height"===e?"Top":"Left",l="Height"===e?"Bottom":"Right";return parseFloat(a[e.toLowerCase()])+(i?parseFloat(a["border"+u])+parseFloat(a["border"+l]):0)+(n?parseFloat(a["margin"+u])+parseFloat(a["margin"+l]):0)},innerWidth:function(t){return this.getSize(t,"Width")},innerHeight:function(t){return this.getSize(t,"Height")},isEmptyObject:function(t){var e=void 0;for(e in t)return!1;return!0}},l=function(){function MixinBuilder(t){_classCallCheck(this,MixinBuilder),this.superclass=t||function(){function _class(){_classCallCheck(this,_class)}return _class}()}return MixinBuilder.prototype.with=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return e.reduce(function(t,e){return e(t)},this.superclass)},MixinBuilder}(),c=function(t){return new l(t)};e.Mixin=c,e.utils=u},function(t,e,i){"use strict";e.__esModule=!0;var n="undefined"!=typeof window&&window.Math===Math?window:"undefined"!=typeof self&&self.Math===Math?self:Function("return this")();e.window=n;e.document=n.document},function(t,e,i){"use strict";e.__esModule=!0,e.RETRY=e.IS_IOS=e.IS_IE=void 0;var n=i(1),o=n.window.navigator.userAgent;e.IS_IE=/MSIE|Trident|Windows Phone|Edge/.test(o),e.IS_IOS=/iPhone|iPad/.test(o),e.RETRY=3},function(t,e,i){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},o=i(8),r=_interopRequireDefault(o),s=i(6),a=_interopRequireDefault(s),u=i(1),l=i(2),c=i(0),p=i(4),h=_interopRequireDefault(p),f=i(5),d=_interopRequireDefault(f),y=function(t){function InfiniteGrid(e,i){_classCallCheck(this,InfiniteGrid);var o=_possibleConstructorReturn(this,t.call(this,e,i));return n(o.options={isEqualSize:!1,defaultGroupKey:null,count:30,threshold:300},i),o.view=window,o.el=c.utils.$(e),o.layoutManager=new d.default(o.el,o.options),o._reset(),o._resizeViewport(),o.el.children.length>0&&o.layout(!0,d.default.itemize(o.el.children,o.options.defaultGroupKey)),o._attachEvent(),o}return _inherits(InfiniteGrid,t),InfiniteGrid.prototype._resizeViewport=function(){this._status.clientHeight=c.utils.innerHeight(this.view)},InfiniteGrid.prototype.getStatus=function(){var t={};for(var e in this._status)!Object.prototype.hasOwnProperty.call(this._status,e)||this._status[e]instanceof Element||(t[e]=this._status[e]);return{html:this.el.innerHTML,cssText:this.el.style.cssText,layoutManager:this.layoutManager.getStatus(),options:n({},this.options),prop:t}},InfiniteGrid.prototype.setStatus=function(t){return t&&t.options&&t.prop&&t.layoutManager&&t.html&&t.cssText?(this.el.style.cssText=t.cssText,this.el.innerHTML=t.html,n(this.options,t.options),n(this._status,t.prop),this.layoutManager.setStatus(t.layoutManager),this._status.topElement=this.getTopElement(),this._status.bottomElement=this.getBottomElement(),this):this},InfiniteGrid.prototype.isProcessing=function(){return this._status.isProcessing},InfiniteGrid.prototype.isRecycling=function(){return this.options.count>0&&this._status.isRecycling},InfiniteGrid.prototype.getGroupKeys=function(){return this.layoutManager.getGroupKeys()},InfiniteGrid.prototype.layout=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments[1],i=arguments[2];this._status.isProcessing=!0;var o=n({isAppend:!0,removedCount:0},i);return e||o.isAppend||(o.isAppend=!0),this._waitResource(t,o.isAppend?e:e.reverse(),o),this},InfiniteGrid.prototype._onLayoutComplete=function(t,e,i){this.layoutManager.layoutItems(t,e,i),this._postLayout(t,e,i)},InfiniteGrid.prototype.append=function(t,e){return this._insert(t,e,!0)},InfiniteGrid.prototype.prepend=function(t,e){return this._insert(t,e,!1)},InfiniteGrid.prototype.clear=function(){return this.el.innerHTML="",this.el.style.height="",this._reset(),this},InfiniteGrid.prototype.getTopElement=function(){var t=this.layoutManager.getTopItem();return t&&t.el},InfiniteGrid.prototype.getBottomElement=function(){var t=this.layoutManager.getBottomItem();return t&&t.el},InfiniteGrid.prototype._resizeContainerHeight=function(){this.el.style.height=this.layoutManager.getLogicalHeight()+"px"},InfiniteGrid.prototype._postLayout=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments[2];if(this.isProcessing()){this._resizeContainerHeight(),this._timer.doubleCheckCount=l.RETRY,this._status.topElement=this.getTopElement(),this._status.bottomElement=this.getBottomElement();var n=0;i.isAppend||(n=e.length>=this.layoutManager.items.length?0:this.layoutManager.items[e.length].position.y)>0&&(this._status.prevScrollTop=c.utils.scrollTop()+n,this.view.scrollTo(0,this._status.prevScrollTop)),this._status.isProcessing=!1,this.trigger("layoutComplete",{target:e.concat(),isAppend:i.isAppend,distance:n,croppedCount:i.removedCount}),!i.isAppend&&this._doubleCheckForPrepend()}},InfiniteGrid.prototype._doubleCheckForPrepend=function(){var t=this;0===c.utils.scrollTop()&&(clearInterval(this._timer.doubleCheck),this._timer.doubleCheck=setInterval(function(){0===c.utils.scrollTop()&&(t.trigger("prepend",{scrollTop:0}),--t._timer.doubleCheckCount<=0&&clearInterval(t._timer.doubleCheck))},500))},InfiniteGrid.prototype._prepareElement=function(t){var e=c.utils.$(t,!0);return e=e.filter(function(t){return/DIV|SPAN|LI/.test(t.tagName)}),this._status.isProcessing=!0,this.isRecycling()||(this._status.isRecycling=this.layoutManager.items.length+e.length>=this.options.count),e},InfiniteGrid.prototype._insert=function(t,e,i){if(this.isProcessing()||0===t.length)return 0;var n=this._prepareElement(t),o=n.concat(),r=-this._status.clientHeight+"px";n.forEach(function(t){t.style.position="absolute",t.style.top=r});var s=this._adjustRange(i,o),a=u.document.createDocumentFragment();return o.forEach(function(t){return a.appendChild(t)}),i?this.el.appendChild(a):this.el.insertBefore(a,this.el.firstChild),this.layout(!1,d.default.itemize(o,e),{isAppend:i,removedCount:s}),o.length},InfiniteGrid.prototype._waitResource=function(t,e,i){var n=h.default.checkImageLoaded(this.el),o=function(){this._onLayoutComplete(t,e,i)}.bind(this);n.length>0?h.default.waitImageLoaded(n,o):setTimeout(function(){o&&o()},0)},InfiniteGrid.prototype._adjustRange=function(t,e){var i=0;if(!this.isRecycling())return i;this.options.count<=e.length&&(i+=t?e.splice(0,e.length-this.options.count).length:e.splice(this.options.count).length);var n=this.layoutManager.items.length+e.length-this.options.count,o=void 0;if(n<=0||(o=this.layoutManager.getDelimiterIndex(t,n))<0)return i;var r=this.layoutManager.adjustItems(t,o);return r.forEach(function(t){o=e.indexOf(t.el),-1!==o?e.splice(o,1):t.el.parentNode.removeChild(t.el)}),i+=r.length},InfiniteGrid.prototype._fitItems=function(){var t=this.layoutManager.fit();return 0!==t&&this._resizeContainerHeight(),t},InfiniteGrid.prototype._reset=function(){this._status={isProcessing:!1,isRecycling:!1,prevScrollTop:0,topElement:null,bottomElement:null,clientHeight:this._status&&this._status.clientHeight},this._timer={resize:null,doubleCheck:null,doubleCheckCount:l.RETRY},this.layoutManager.resetCols(),this.layoutManager.clear()},InfiniteGrid.prototype.remove=function(t){return this.layoutManager.removeItem(t)},InfiniteGrid.prototype.destroy=function(){this.off(),this._detachEvent(),this._reset()},InfiniteGrid}((0,c.Mixin)(r.default).with(a.default));e.default=y,t.exports=e.default},function(t,e,i){"use strict";e.__esModule=!0;var n=i(2),o=i(0),r={checkImageLoaded:function(t){return Array.prototype.slice.call(t.querySelectorAll("img")).filter(function(t){return!(!t.nodeType||-1===[1,9,11].indexOf(t.nodeType))&&!t.complete})},waitImageLoaded:function(t,e){var i=t.length,r=function onCheck(t){i--,o.utils.removeEvent(t.target,"load",onCheck),o.utils.removeEvent(t.target,"error",onCheck),i<=0&&e&&e()};t.forEach(function(t){if(n.IS_IE){var e=t.getAttribute("src");t.setAttribute("src",""),t.setAttribute("src",e)}o.utils.addEvent(t,"load",r),o.utils.addEvent(t,"error",r)})}};e.default=r,t.exports=e.default},function(t,e,i){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},o=i(0),r=function(){function LayoutManager(t,e){_classCallCheck(this,LayoutManager),this.options=e,this.size={columnWidth:null,containerWidth:null,equalItemSize:null},this.el=t,this.el.style.position="relative",this.clear(),this.prependCols=[],this.appendCols=[]}return LayoutManager.itemize=function(t,e,i){return Array.prototype.slice.call(t).map(function(t){return{el:t,position:{x:0,y:0},groupKey:void 0===e?null:e}})},LayoutManager.prototype.appendItems=function(t){this.items=this.items.concat(t)},LayoutManager.prototype.prependItems=function(t){this.items=t.concat(this.items);var e=this.getTopPositonY();return 0!==e?(this.items.forEach(function(t){t.position.y-=e}),this.syncCols(!1),this.syncCols(!0),this.items):t},LayoutManager.prototype.removeItem=function(t){for(var e=null,i=-1,o=0,r=this.items.length;o<r;o++)if(this.items[o].el===t){i=o;break}return~i&&(e=n({},this.items[i]),this.items.splice(i,1),e.el.parentNode.removeChild(e.el)),e},LayoutManager.prototype.prepareLayout=function(t,e,i){var n=!this.items.length;e&&i&&this.appendItems(e),n&&e&&e.forEach(function(t){t.el.style.position="absolute"}),n||t?this.resetCols(this.measureColumns()):e||(this.appendCols=[].concat(this.prependCols))},LayoutManager.prototype.layoutItems=function(t,e,i){var n=this;this.prepareLayout(t,e,i.isAppend);var o=e||this.items;o.forEach(function(e){e.position=n.getItemPosition(t,e,i.isAppend)}),e&&!i.isAppend&&(o=this.prependItems(e.sort(function(t,e){return t.position.y-e.position.y})));var r=void 0;o.forEach(function(t){t.el&&(r=t.el.style,r.left=t.position.x+"px",r.top=t.position.y+"px")})},LayoutManager.prototype.resetCols=function(t){for(var e=[],i=t||this.appendCols.length||0;i--;)e.push(0);this.appendCols=e.concat(),this.prependCols=e.concat()},LayoutManager.prototype.clear=function(){this.items=[]},LayoutManager.prototype.getItemPosition=function(t,e,i){if(!e||!e.el)return{x:0,y:0};!t&&e.size||(e.size=this.getItemSize(e.el));var n=i?this.appendCols:this.prependCols,o=Math[i?"min":"max"].apply(Math,n),r=void 0;if(i)r=n.indexOf(o);else for(var s=n.length;s-- >=0;)if(n[s]===o){r=s;break}return n[r]=o+(i?e.size.height:-e.size.height),{x:this.size.columnWidth*r,y:i?o:o-e.size.height}},LayoutManager.prototype.getGroupKeys=function(){return this.items.map(function(t){return t.groupKey})},LayoutManager.prototype.syncCols=function(t){if(this.items.length)for(var e=this.getColItems(t),i=t?this.appendCols:this.prependCols,n=i.length,o=0;o<n;o++)i[o]=e[o].position.y+(t?e[o].size.height:0)},LayoutManager.prototype.getTopPositonY=function(){var t=this.getTopItem();return t?t.position.y:0},LayoutManager.prototype.getTopItem=function(){var t=null,e=1/0;return this.getColItems(!1).forEach(function(i){i&&i.position.y<e&&(e=i.position.y,t=i)}),t},LayoutManager.prototype.getBottomItem=function(){var t=-1/0,e=null,i=void 0;return this.getColItems(!0).forEach(function(n){(i=n?n.position.y+n.size.height:0)>=t&&(t=i,e=n)}),e},LayoutManager.prototype.getColIdx=function(t){return parseInt(t.position.x/parseInt(this.size.columnWidth,10),10)},LayoutManager.prototype.getColItems=function(t){for(var e=this.appendCols.length,i=new Array(e),n=void 0,o=void 0,r=0,s=t?this.items.length-1:0;n=this.items[s];){if(o=this.getColIdx(n),!i[o]&&(i[o]=n,++r===e))return i;s+=t?-1:1}return i},LayoutManager.prototype.fit=function(){if(this.options.count<=0)return this.fit=function(){return 0},!1;var t=this.getTopPositonY();return 0!==t&&(this.items.forEach(function(e){e.position.y-=t,e.el.style.top=e.position.y+"px"}),this.syncCols(!1),this.syncCols(!0)),t},LayoutManager.prototype.getLogicalHeight=function(){return Math.max.apply(Math,this.appendCols)},LayoutManager.prototype.getDelimiterIndex=function(t,e){var i=this.items.length;if(i===e)return i;var n=void 0,o=0,r=t?e-1:i-e,s=r+(t?1:-1),a=this.items[r].groupKey;if(null!=a&&a===this.items[s].groupKey)if(t){for(n=r;n>0&&a===this.items[n].groupKey;n--);o=0===n?-1:n+1}else{for(n=r;n<i&&a===this.items[n].groupKey;n++);o=n===i?-1:n}else o=t?s:r;return o},LayoutManager.prototype.adjustItems=function(t,e){var i=void 0;return t?(i=this.items.splice(0,e),this.syncCols(!1)):(i=e===this.items.length?this.items.splice(0):this.items.splice(e,this.items.length-e),this.syncCols(!0)),i},LayoutManager.prototype.measureColumns=function(){this.el.style.width=null,this.size.containerWidth=o.utils.innerWidth(this.el),this.size.columnWidth=this.getColumnWidth()||this.size.containerWidth;var t=this.size.containerWidth/this.size.columnWidth,e=this.size.columnWidth-this.size.containerWidth%this.size.columnWidth;return(t=Math.max(Math[e&&e<=1?"round":"floor"](t),1))||0},LayoutManager.prototype.getItemSize=function(t){return this.size.equalItemSize||{width:o.utils.innerWidth(t),height:o.utils.innerHeight(t)}},LayoutManager.prototype.getColumnWidth=function(){var t=0,e=this.items[0]&&this.items[0].el;return e&&(t=o.utils.innerWidth(e),this.options.isEqualSize&&(this.size.equalItemSize={width:t,height:o.utils.innerHeight(e)})),t},LayoutManager.prototype.isNeededResize=function(){return o.utils.innerWidth(this.el)!==this.size.containerWidth},LayoutManager.prototype.getStatus=function(){var t={};for(var e in this)!Object.prototype.hasOwnProperty.call(this,e)||"function"==typeof this[e]||this[e]instanceof Element||(t[e]=this[e]);return{prop:t,items:this.items.map(function(t){var e=n({},t);return delete e.el,e})}},LayoutManager.prototype.setStatus=function(t){return t&&t.prop&&t.items?(n(this,t.prop),this.items=Array.prototype.slice.call(this.el.children).map(function(e,i){return t.items[i].el=e,t.items[i]}),this):this},LayoutManager}();e.default=r,t.exports=e.default},function(t,e,i){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var n=i(2),o=i(0);e.default=function(t){return function(t){function _class(e,i){_classCallCheck(this,_class);var n=_possibleConstructorReturn(this,t.call(this));return n._onScroll=n._onScroll.bind(n),n._onResize=n._onResize.bind(n),n}return _inherits(_class,t),_class.prototype._attachEvent=function(){o.utils.addEvent(this.view,"scroll",this._onScroll),o.utils.addEvent(this.view,"resize",this._onResize)},_class.prototype._onScroll=function(){if(!this.isProcessing()){var t=o.utils.scrollTop(),e=this._status.prevScrollTop;if(!(n.IS_IOS&&0===t||e===t)){var i=void 0,r=void 0;if(e<t){if(o.utils.isEmptyObject(this._status.bottomElement)&&(this._status.bottomElement=this.getBottomElement(),null==this._status.bottomElement))return;i=this._status.bottomElement,r=i.getBoundingClientRect(),r.top<=this._status.clientHeight+this.options.threshold&&this.trigger("append",{scrollTop:t})}else{if(o.utils.isEmptyObject(this._status.topElement)&&(this._status.topElement=this.getTopElement(),null==this._status.topElement))return;if(i=this._status.topElement,r=i.getBoundingClientRect(),r.bottom>=-this.options.threshold){var s=this._fitItems();s>0&&(t-=s,this.view.scrollTo(0,t)),this.trigger("prepend",{scrollTop:t})}}this._status.prevScrollTop=t}}},_class.prototype._onResize=function(){var t=this;this._timer.resize&&clearTimeout(this._timer.resize),this._timer.resize=setTimeout(function(){t.layoutManager.isNeededResize()&&(t._resizeViewport(),t.layout(!0)),t._timer.resize=null,t._status.prevScrollTop=-1},100)},_class.prototype._detachEvent=function(){o.utils.removeEvent(this.view,"scroll",this._onScroll),o.utils.removeEvent(this.view,"resize",this._onResize)},_class}(t)},t.exports=e.default},function(t,e,i){"use strict";var n=i(3),o=function(t){return t&&t.__esModule?t:{"default":t}}(n);o.default.VERSION="2.0.0-rc.1",t.exports=o.default},function(e,i){e.exports=t}])});
//# sourceMappingURL=infinitegrid.min.js.map