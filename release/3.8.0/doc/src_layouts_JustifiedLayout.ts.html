<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: src/layouts/JustifiedLayout.ts | egjs::infinitegrid - API</title>
    
    <meta name="description" content="A module used to arrange card elements including content infinitely according to layout type. With this module, you can implement various layouts composed of different card elements whose sizes vary. It guarantees performance by maintaining the number of DOMs the module is handling under any circumstance" />
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <link rel="canonical" href="http://naver.github.io/egjs-infinitegrid/release/latest/doc/"/>
    
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"default":{"outputSourceFiles":true},"applicationName":"eg.InfiniteGrid","disqus":"egjs","googleAnalytics":"UA-70842526-18","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"egjs::infinitegrid - API","description":"A module used to arrange card elements including content infinitely according to layout type. With this module, you can implement various layouts composed of different card elements whose sizes vary. It guarantees performance by maintaining the number of DOMs the module is handling under any circumstance","keyword":""},"linenums":true,"link":{"canonical":"http://naver.github.io/egjs-infinitegrid/release/latest/doc/"}};
    </script>
    

    
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', config.googleAnalytics]);
      _gaq.push(['_trackPageview']);
    
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName">
        <a href="//naver.github.io/egjs/"><img style="width:40px; height:20px;" src="img/type_white.svg"/></a>

        <!-- Homepage link (prefer link.home than applicationName) -->
        
        <a href="//naver.github.io/egjs-infinitegrid/">InfiniteGrid</a>
        
    </h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
        <li class="item">
            <span class="title">
                <a href="index.html">README</a>
            </span>
        </li>
    
        <!-- Non Grouping Version -->
        
            

<li class="item" data-name="eg.Parallax">
    <span class="title">
        <a href="eg.Parallax.html">eg.Parallax</a>
        
    </span>
    <ul class="members itemMembers expends">
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    <span class="subtitle">Methods</span>
    
        <li data-name="eg.Parallax#refresh"><a href="eg.Parallax.html#refresh">refresh</a></li>
    
        <li data-name="eg.Parallax#resize"><a href="eg.Parallax.html#resize">resize</a></li>
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.InfiniteGrid.SquareLayout">
    <span class="title">
        <a href="eg.InfiniteGrid.SquareLayout.html">eg.InfiniteGrid.SquareLayout</a>
        
    </span>
    <ul class="members itemMembers expends">
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    <span class="subtitle">Methods</span>
    
        <li data-name="eg.InfiniteGrid.SquareLayout#append"><a href="eg.InfiniteGrid.SquareLayout.html#append">append</a> <img src="img/i.png" width="14" title="inherited" alt="inherited"></li>
    
        <li data-name="eg.InfiniteGrid.SquareLayout#layout"><a href="eg.InfiniteGrid.SquareLayout.html#layout">layout</a> <img src="img/i.png" width="14" title="inherited" alt="inherited"></li>
    
        <li data-name="eg.InfiniteGrid.SquareLayout#prepend"><a href="eg.InfiniteGrid.SquareLayout.html#prepend">prepend</a> <img src="img/i.png" width="14" title="inherited" alt="inherited"></li>
    
        <li data-name="eg.InfiniteGrid.SquareLayout#setSize"><a href="eg.InfiniteGrid.SquareLayout.html#setSize">setSize</a> <img src="img/i.png" width="14" title="inherited" alt="inherited"></li>
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.InfiniteGrid.PackingLayout">
    <span class="title">
        <a href="eg.InfiniteGrid.PackingLayout.html">eg.InfiniteGrid.PackingLayout</a>
        
    </span>
    <ul class="members itemMembers expends">
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    <span class="subtitle">Methods</span>
    
        <li data-name="eg.InfiniteGrid.PackingLayout#append"><a href="eg.InfiniteGrid.PackingLayout.html#append">append</a></li>
    
        <li data-name="eg.InfiniteGrid.PackingLayout#layout"><a href="eg.InfiniteGrid.PackingLayout.html#layout">layout</a></li>
    
        <li data-name="eg.InfiniteGrid.PackingLayout#prepend"><a href="eg.InfiniteGrid.PackingLayout.html#prepend">prepend</a></li>
    
        <li data-name="eg.InfiniteGrid.PackingLayout#setSize"><a href="eg.InfiniteGrid.PackingLayout.html#setSize">setSize</a></li>
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.InfiniteGrid.JustifiedLayout">
    <span class="title">
        <a href="eg.InfiniteGrid.JustifiedLayout.html">eg.InfiniteGrid.JustifiedLayout</a>
        
    </span>
    <ul class="members itemMembers expends">
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    <span class="subtitle">Methods</span>
    
        <li data-name="eg.InfiniteGrid.JustifiedLayout#append"><a href="eg.InfiniteGrid.JustifiedLayout.html#append">append</a></li>
    
        <li data-name="eg.InfiniteGrid.JustifiedLayout#layout"><a href="eg.InfiniteGrid.JustifiedLayout.html#layout">layout</a></li>
    
        <li data-name="eg.InfiniteGrid.JustifiedLayout#prepend"><a href="eg.InfiniteGrid.JustifiedLayout.html#prepend">prepend</a></li>
    
        <li data-name="eg.InfiniteGrid.JustifiedLayout#setSize"><a href="eg.InfiniteGrid.JustifiedLayout.html#setSize">setSize</a></li>
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.InfiniteGrid.GridLayout">
    <span class="title">
        <a href="eg.InfiniteGrid.GridLayout.html">eg.InfiniteGrid.GridLayout</a>
        
    </span>
    <ul class="members itemMembers expends">
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    <span class="subtitle">Methods</span>
    
        <li data-name="eg.InfiniteGrid.GridLayout#append"><a href="eg.InfiniteGrid.GridLayout.html#append">append</a></li>
    
        <li data-name="eg.InfiniteGrid.GridLayout#layout"><a href="eg.InfiniteGrid.GridLayout.html#layout">layout</a></li>
    
        <li data-name="eg.InfiniteGrid.GridLayout#prepend"><a href="eg.InfiniteGrid.GridLayout.html#prepend">prepend</a></li>
    
        <li data-name="eg.InfiniteGrid.GridLayout#setSize"><a href="eg.InfiniteGrid.GridLayout.html#setSize">setSize</a></li>
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.InfiniteGrid.FrameLayout">
    <span class="title">
        <a href="eg.InfiniteGrid.FrameLayout.html">eg.InfiniteGrid.FrameLayout</a>
        
    </span>
    <ul class="members itemMembers expends">
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    <span class="subtitle">Methods</span>
    
        <li data-name="eg.InfiniteGrid.FrameLayout#append"><a href="eg.InfiniteGrid.FrameLayout.html#append">append</a></li>
    
        <li data-name="eg.InfiniteGrid.FrameLayout#layout"><a href="eg.InfiniteGrid.FrameLayout.html#layout">layout</a></li>
    
        <li data-name="eg.InfiniteGrid.FrameLayout#prepend"><a href="eg.InfiniteGrid.FrameLayout.html#prepend">prepend</a></li>
    
        <li data-name="eg.InfiniteGrid.FrameLayout#setSize"><a href="eg.InfiniteGrid.FrameLayout.html#setSize">setSize</a></li>
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.InfiniteGrid">
    <span class="title">
        <a href="eg.InfiniteGrid.html">eg.InfiniteGrid</a>
        
    </span>
    <ul class="members itemMembers expends">
    
    <span class="subtitle">Members</span>
    
        <li data-name="eg.InfiniteGrid.VERSION"><a href="eg.InfiniteGrid.html#.VERSION">VERSION</a></li>
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    <span class="subtitle">Typedefs</span>
    
        <li data-name="eg.InfiniteGrid.IErrorCallbackOptions"><a href="eg.InfiniteGrid.html#.IErrorCallbackOptions">IErrorCallbackOptions</a></li>
    
        <li data-name="eg.InfiniteGrid.IInfiniteGridItem"><a href="eg.InfiniteGrid.html#.IInfiniteGridItem">IInfiniteGridItem</a></li>
    
        <li data-name="eg.InfiniteGrid.IPosition"><a href="eg.InfiniteGrid.html#.IPosition">IPosition</a></li>
    
        <li data-name="eg.InfiniteGrid.ISize"><a href="eg.InfiniteGrid.html#.ISize">ISize</a></li>
    
    </ul>
    <ul class="methods itemMembers expends">
    
    <span class="subtitle">Methods</span>
    
        <li data-name="eg.InfiniteGrid#append"><a href="eg.InfiniteGrid.html#append">append</a></li>
    
        <li data-name="eg.InfiniteGrid#clear"><a href="eg.InfiniteGrid.html#clear">clear</a></li>
    
        <li data-name="eg.InfiniteGrid#destroy"><a href="eg.InfiniteGrid.html#destroy">destroy</a></li>
    
        <li data-name="eg.InfiniteGrid#endLoading"><a href="eg.InfiniteGrid.html#endLoading">endLoading</a></li>
    
        <li data-name="eg.InfiniteGrid#getGroupKeys"><a href="eg.InfiniteGrid.html#getGroupKeys">getGroupKeys</a></li>
    
        <li data-name="eg.InfiniteGrid#getItem"><a href="eg.InfiniteGrid.html#getItem">getItem</a></li>
    
        <li data-name="eg.InfiniteGrid#getItems"><a href="eg.InfiniteGrid.html#getItems">getItems</a></li>
    
        <li data-name="eg.InfiniteGrid#getLoadingBar"><a href="eg.InfiniteGrid.html#getLoadingBar">getLoadingBar</a></li>
    
        <li data-name="eg.InfiniteGrid#getStatus"><a href="eg.InfiniteGrid.html#getStatus">getStatus</a></li>
    
        <li data-name="eg.InfiniteGrid#hasOn"><a href="eg.InfiniteGrid.html#hasOn">hasOn</a> <img src="img/i.png" width="14" title="inherited" alt="inherited"></li>
    
        <li data-name="eg.InfiniteGrid#isLoading"><a href="eg.InfiniteGrid.html#isLoading">isLoading</a></li>
    
        <li data-name="eg.InfiniteGrid#isProcessing"><a href="eg.InfiniteGrid.html#isProcessing">isProcessing</a></li>
    
        <li data-name="eg.InfiniteGrid#layout"><a href="eg.InfiniteGrid.html#layout">layout</a></li>
    
        <li data-name="eg.InfiniteGrid#moveTo"><a href="eg.InfiniteGrid.html#moveTo">moveTo</a></li>
    
        <li data-name="eg.InfiniteGrid#off"><a href="eg.InfiniteGrid.html#off">off</a> <img src="img/i.png" width="14" title="inherited" alt="inherited"></li>
    
        <li data-name="eg.InfiniteGrid#on"><a href="eg.InfiniteGrid.html#on">on</a> <img src="img/i.png" width="14" title="inherited" alt="inherited"></li>
    
        <li data-name="eg.InfiniteGrid#once"><a href="eg.InfiniteGrid.html#once">once</a> <img src="img/i.png" width="14" title="inherited" alt="inherited"></li>
    
        <li data-name="eg.InfiniteGrid#prepend"><a href="eg.InfiniteGrid.html#prepend">prepend</a></li>
    
        <li data-name="eg.InfiniteGrid#remove"><a href="eg.InfiniteGrid.html#remove">remove</a></li>
    
        <li data-name="eg.InfiniteGrid#removeByIndex"><a href="eg.InfiniteGrid.html#removeByIndex">removeByIndex</a></li>
    
        <li data-name="eg.InfiniteGrid#setLayout"><a href="eg.InfiniteGrid.html#setLayout">setLayout</a></li>
    
        <li data-name="eg.InfiniteGrid#setLoadingBar"><a href="eg.InfiniteGrid.html#setLoadingBar">setLoadingBar</a></li>
    
        <li data-name="eg.InfiniteGrid#setStatus"><a href="eg.InfiniteGrid.html#setStatus">setStatus</a></li>
    
        <li data-name="eg.InfiniteGrid#startLoading"><a href="eg.InfiniteGrid.html#startLoading">startLoading</a></li>
    
        <li data-name="eg.InfiniteGrid#trigger"><a href="eg.InfiniteGrid.html#trigger">trigger</a> <img src="img/i.png" width="14" title="inherited" alt="inherited"></li>
    
        <li data-name="eg.InfiniteGrid#updateItem"><a href="eg.InfiniteGrid.html#updateItem">updateItem</a></li>
    
        <li data-name="eg.InfiniteGrid#updateItems"><a href="eg.InfiniteGrid.html#updateItems">updateItems</a></li>
    
    </ul>
    <ul class="events itemMembers expends">
    
    <span class="subtitle">Events</span>
    
        <li data-name="eg.InfiniteGrid#event:append"><a href="eg.InfiniteGrid.html#event:append">append</a></li>
    
        <li data-name="eg.InfiniteGrid#event:change"><a href="eg.InfiniteGrid.html#event:change">change</a></li>
    
        <li data-name="eg.InfiniteGrid#event:contentError"><a href="eg.InfiniteGrid.html#event:contentError">contentError</a></li>
    
        <li data-name="eg.InfiniteGrid#event:imageError"><a href="eg.InfiniteGrid.html#event:imageError">imageError</a></li>
    
        <li data-name="eg.InfiniteGrid#event:layoutComplete"><a href="eg.InfiniteGrid.html#event:layoutComplete">layoutComplete</a></li>
    
        <li data-name="eg.InfiniteGrid#event:prepend"><a href="eg.InfiniteGrid.html#event:prepend">prepend</a></li>
    
    </ul>

    
</li>

        
            

        
    
    </ul>
</div>

    <div class="main">
        <h1 class="page-title" data-filename="src_layouts_JustifiedLayout.ts.html">Source: src/layouts/JustifiedLayout.ts</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { find_path } from "./lib/dijkstra";
import { getStyleNames, assignOptions, cloneItems, isObject, getRangeCost } from "../utils";
import {
	ILayout,
	IRectlProperties,
	SizeType,
	IInfiniteGridItem,
	IInfiniteGridGroup,
} from "../types";

interface Link {
	path: number[];
	cost: number;
	length: number;
	currentNode: number;
	isOver?: boolean;
}

/**
 * @classdesc 'justified' is a printing term with the meaning that 'it fits in one row wide'. JustifiedLayout is a layout that the card is filled up on the basis of a line given a size.
 * @ko 'justified'는 '1행의 너비에 맞게 꼭 들어찬'이라는 의미를 가진 인쇄 용어다. 용어의 의미대로 너비가 주어진 사이즈를 기준으로 카드가 가득 차도록 배치하는 레이아웃이다.
 * @class eg.InfiniteGrid.JustifiedLayout
 * @param {Object} [options] The option object of eg.InfiniteGrid.JustifiedLayout module &lt;ko>eg.InfiniteGrid.JustifiedLayout 모듈의 옵션 객체&lt;/ko>
 * @param {String} [options.margin=0] Margin used to create space around items &lt;ko>아이템들 사이의 공간&lt;/ko>
 * @param {Boolean} [options.horizontal=false] Direction of the scroll movement (false: vertical, true: horizontal) &lt;ko>스크롤 이동 방향 (false: 세로방향, true: 가로방향)&lt;/ko>
 * @param {Number} [options.minSize=0] Minimum size of item to be resized &lt;ko> 아이템이 조정되는 최소 크기 &lt;/ko>
 * @param {Number} [options.maxSize=0] Maximum size of item to be resized &lt;ko> 아이템이 조정되는 최대 크기 &lt;/ko>
 * @param {Array|Number} [options.column=[1, 8]] The number of items in a line &lt;ko> 한 줄에 들어가는 아이템의 개수 &lt;/ko>
 * @param {Array|Number} [options.row=0] The number or range of rows in a group, 0 is not set &lt;ko>한 그룹에 들어가는 열의 개수, 0은 미설정이다&lt;/ko>
 * @example
```
&lt;script>
var ig = new eg.InfiniteGrid("#grid". {
  horizontal: true,
});

ig.setLayout(eg.InfiniteGrid.JustifiedLayout, {
  margin: 10,
  minSize: 100,
  maxSize: 300,
});

// or

var layout = new eg.InfiniteGrid.JustifiedLayout({
  margin: 10,
  minSize: 100,
  maxSize: 300,
  column: 5,
  horizontal: true,
});

&lt;/script>
```
 **/
class JustifiedLayout implements ILayout {
	public options: {
		margin: number;
		minSize: number;
		maxSize: number;
		column: number | number[];
		horizontal: boolean;
		row: number | number[];
	};
	private _style: IRectlProperties;
	private _size: number;

	constructor(options: Partial&lt;JustifiedLayout["options"]> = {}) {
		this.options = assignOptions(
			{
				margin: 0,
				horizontal: false,
				minSize: 0,
				maxSize: 0,
				column: [1, 8],
				row: 0,
			},
			options
		);

		this._style = getStyleNames(this.options.horizontal);
		this._size = 0;
	}
	/**
	 * Set the viewport size of the layout.
	 * @ko 레이아웃의 가시 사이즈를 설정한다.
	 * @method eg.InfiniteGrid.JustifiedLayout#setSize
	 * @param {Number} size The viewport size of container area where items are added to a layout &lt;ko>레이아웃에 아이템을 추가하는 컨테이너 영역의 가시 사이즈&lt;/ko>
	 * @return {eg.InfiniteGrid.JustifiedLayout} An instance of a module itself&lt;ko>모듈 자신의 인스턴스&lt;/ko>
	 * @example
	 * layout.setSize(800);
	 */
	public setSize(size: number) {
		this._size = size;
		return this;
	}
	/**
	 * Adds items at the bottom of a outline.
	 * @ko 아이템들을 아웃라인 아래에 추가한다.
	 * @method eg.InfiniteGrid.JustifiedLayout#append
	 * @param {Array} items Array of items to be layouted &lt;ko>레이아웃할 아이템들의 배열&lt;/ko>
	 * @param {Array} [outline=[]] Array of outline points to be reference points &lt;ko>기준점이 되는 아웃라인 점들의 배열&lt;/ko>
	 * @return {Object} Layouted items and outline of start and end &lt;ko> 레이아웃이 된 아이템과 시작과 끝의 아웃라인이 담긴 정보&lt;/ko>
	 * @example
	 * layout.prepend(items, [100]);
	 */
	public append(items: IInfiniteGridItem[], outline?: number[], cache?: boolean) {
		return this._insert(items, outline, true, cache);
	}
	/**
	 * Adds items at the top of a outline.
	 * @ko 아이템을 아웃라인 위에 추가한다.
	 * @method eg.InfiniteGrid.JustifiedLayout#prepend
	 * @param {Array} items Array of items to be layouted &lt;ko>레이아웃할 아이템들의 배열&lt;/ko>
	 * @param {Array} [outline=[]] Array of outline points to be reference points &lt;ko>기준점이 되는 아웃라인 점들의 배열&lt;/ko>
	 * @return {Object} Layouted items and outline of start and end &lt;ko> 레이아웃이 된 아이템과 시작과 끝의 아웃라인이 담긴 정보&lt;/ko>
	 * @example
	 * layout.prepend(items, [100]);
	 */
	public prepend(items: IInfiniteGridItem[], outline?: number[], cache?: boolean) {
		return this._insert(items, outline, false, cache);
	}
	/**
	 * Adds items of groups at the bottom of a outline.
	 * @ko 그룹들의 아이템들을 아웃라인 아래에 추가한다.
	 * @method eg.InfiniteGrid.JustifiedLayout#layout
	 * @param {Array} groups Array of groups to be layouted &lt;ko>레이아웃할 그룹들의 배열&lt;/ko>
	 * @param {Array} outline Array of outline points to be reference points &lt;ko>기준점이 되는 아웃라인 점들의 배열&lt;/ko>
	 * @return {eg.InfiniteGrid.JustifiedLayout} An instance of a module itself&lt;ko>모듈 자신의 인스턴스&lt;/ko>
	 * @example
	 * layout.layout(groups, [100]);
	 */
	public layout(groups: IInfiniteGridGroup[] = [], outline: number[] = []) {
		const length = groups.length;
		let point = outline;

		for (let i = 0; i &lt; length; ++i) {
			const group = groups[i];
			const outlines = this._layout(group.items, point, true);

			group.outlines = outlines;
			point = outlines.end;
		}
		return this;
	}
	private _layout(items: IInfiniteGridItem[], outline: number[], isAppend?: boolean) {
		const row = this.options.row;
		let path: string[] = [];

		if (items.length) {
			path = row ? this._getRowPath(items) : this._getPath(items);
		}
		return this._setStyle(items, path, outline, isAppend);
	}

	private _getPath(items: IInfiniteGridItem[]) {
		const lastNode = items.length;
		const column = this.options.column;
		const [minColumn, maxColumn]: number[] = isObject(column)
			? column
			: [column, column];

		const graph = (nodeKey: string) => {
			const results: { [key: string]: number } = {};
			const currentNode = parseInt(nodeKey, 10);

			for (let nextNode = Math.min(currentNode + minColumn, lastNode); nextNode &lt;= lastNode; ++nextNode) {
				if (nextNode - currentNode > maxColumn) {
					break;
				}
				let cost = this._getCost(
					items,
					currentNode,
					nextNode,
				);

				if (cost &lt; 0 &amp;&amp; nextNode === lastNode) {
					cost = 0;
				}
				results[`${nextNode}`] = Math.pow(cost, 2);
			}
			return results;
		};
		// shortest path for items' total height.
		return find_path(graph, "0", `${lastNode}`);
	}
	private _getRowPath(items: IInfiniteGridItem[]) {
		const column = this.options.column;
		const row = this.options.row;
		const columnRange = isObject(column) ? column : [column, column];
		const rowRange: number[] = isObject(row) ? row : [row, row];
		const pathLink = this._getRowLink(items, {
			path: [0],
			cost: 0,
			length: 0,
			currentNode: 0,
		}, columnRange, rowRange);

		return pathLink?.path.map((node) => `${node}`) ?? [];
	}
	private _getRowLink(
		items: IInfiniteGridItem[],
		currentLink: Link,
		columnRange: number[],
		rowRange: number[]
	): Link {
		const [minColumn, maxColumn] = columnRange;
		const [minRow, maxRow] = rowRange;
		const lastNode = items.length;
		const {
			path,
			length: pathLength,
			cost,
			currentNode
		} = currentLink;

		// not reached lastNode but path is exceed or the number of remaining nodes is less than minColumn.
		if (currentNode &lt; lastNode &amp;&amp; (maxRow &lt;= pathLength || currentNode + minColumn > lastNode)) {
			const rangeCost = getRangeCost(lastNode - currentNode, columnRange);
			const lastCost = rangeCost * Math.abs(this._getCost(items, currentNode, lastNode));

			return {
				...currentLink,
				length: pathLength + 1,
				path: [...path, length],
				currentNode: lastNode,
				cost: cost + lastCost,
				isOver: true,
			};
		} else if (currentNode >= lastNode) {
			return {
				...currentLink,
				currentNode: lastNode,
				isOver: minRow > pathLength || maxRow &lt; pathLength,
			};
		} else {
			return this._searchRowLink(items, currentLink, lastNode, columnRange, rowRange);
		}

	}
	private _searchRowLink(
		items: IInfiniteGridItem[],
		currentLink: Link,
		lastNode: number,
		columnRange: number[],
		rowRange: number[]
	) {
		const [minColumn, maxColumn] = columnRange;
		const {
			currentNode,
			path,
			length: pathLength,
			cost
		} = currentLink;
		const length = Math.min(lastNode, currentNode + maxColumn);
		const links: Link[] = [];

		for (let nextNode = currentNode + minColumn; nextNode &lt;= length; ++nextNode) {
			if (nextNode === currentNode) {
				continue;
			}
			const nextCost = Math.abs(this._getCost(items, currentNode, nextNode));
			const nextLink = this._getRowLink(items, {
				path: [...path, nextNode],
				length: pathLength + 1,
				cost: cost + nextCost,
				currentNode: nextNode,
			}, columnRange, rowRange);

			if (nextLink) {
				links.push(nextLink);
			}
		}
		links.sort((a, b) => {
			const aIsOver = a.isOver;
			const bIsOver = b.isOver;

			if (aIsOver !== bIsOver) {
				// If it is over, the cost is high.
				return aIsOver ? 1 : -1;
			}
			const aRangeCost = getRangeCost(a.length, rowRange);
			const bRangeCost = getRangeCost(b.length, rowRange);

			return aRangeCost - bRangeCost || a.cost - b.cost;
		});

		// It returns the lowest cost link.
		return links[0];
	}
	private _getSize(items: IInfiniteGridItem[], size1Name: SizeType, size2Name: SizeType) {
		const margin = this.options.margin;
		const size = items.reduce((sum, item) => sum +
			(item.orgSize![size2Name]) / item.orgSize![size1Name], 0);

		return (this._size - margin * (items.length - 1)) / size;
	}
	private _getCost(
		items: IInfiniteGridItem[],
		i: number,
		j: number,
	) {
		const style = this._style;
		const size1Name = style.size1;
		const size2Name = style.size2;
		const size = this._getSize(items.slice(i, j), size1Name, size2Name);
		const min = this.options.minSize || 0;
		const max = this.options.maxSize || Infinity;

		if (isFinite(max)) {
			// if this size is not in range, the cost increases sharply.
			if (size &lt; min) {
				return Math.pow(size - min, 2) + Math.pow(max, 2);
			} else if (size > max) {
				return Math.pow(size - max, 2) + Math.pow(max, 2);
			} else {
				// if this size in range, the cost is negative or low.
				return Math.min(size - max, min - size);
			}
		}
		// if max is infinite type, caculate cost only with "min".
		if (size &lt; min) {
			return Math.max(Math.pow(min, 2), Math.pow(size, 2));
		}
		return size - min;
	}
	private _setStyle(
		items: IInfiniteGridItem[],
		path: string[],
		outline: number[] = [],
		isAppend?: boolean,
	) {
		const style = this._style;
		// if direction is vertical
		// startPos1 : top, endPos1 : bottom
		// size1 : height
		// startPos2 : left, endPos2 : right
		// size2 : width

		// if direction is horizontal
		// startPos1 : left, endPos1 : right
		// size1 : width
		// startPos2 : top, endPos2 : bottom
		// size2 : height
		const pos1Name = style.startPos1;
		const size1Name = style.size1;
		const pos2Name = style.startPos2;
		const size2Name = style.size2;
		const length = path.length;
		const margin = this.options.margin;
		const startPoint = outline[0] || 0;
		let endPoint = startPoint;
		let height = 0;

		for (let i = 0; i &lt; length - 1; ++i) {
			const path1 = parseInt(path[i], 10);
			const path2 = parseInt(path[i + 1], 10);
			// pathItems(path1 to path2) are in 1 line.
			const pathItems = items.slice(path1, path2);
			const pathItemsLength = pathItems.length;
			const size1 = this._getSize(pathItems, size1Name, size2Name);
			const pos1 = endPoint;

			for (let j = 0; j &lt; pathItemsLength; ++j) {
				const item = pathItems[j];
				const size2 = item.orgSize![size2Name] / item.orgSize![size1Name] * size1;
				// item has margin bottom and right.
				// first item has not margin.
				const prevItemRect = j === 0 ? 0 : pathItems[j - 1].rect;
				const pos2 = (prevItemRect ? prevItemRect[pos2Name] + prevItemRect[size2Name]! + margin : 0);

				item.rect = {
					[pos1Name]: pos1,
					[pos2Name]: pos2,
					[size1Name]: size1,
					[size2Name]: size2,
				} as any;
			}
			height += margin + size1;
			endPoint = startPoint + height;
		}
		const itemsLength = items.length;

		if (isAppend) {
			// previous group's end outline is current group's start outline
			return {
				start: [startPoint],
				end: [endPoint],
			};
		}
		// for prepend, only substract height from position.
		// always start is lower than end.

		for (let i = 0; i &lt; itemsLength; ++i) {
			const item = items[i];

			// move items as long as height for prepend
			item.rect[pos1Name] -= height;
		}
		return {
			start: [startPoint - height],
			end: [startPoint], // endPoint - height = startPoint
		};
	}
	private _insert(items: IInfiniteGridItem[] = [], outline: number[] = [], isAppend?: boolean, cache?: boolean) {
		// this only needs the size of the item.
		const clone = cache ? items : cloneItems(items);

		return {
			items: clone,
			outlines: this._layout(clone, outline, isAppend),
		};
	}
}

export default JustifiedLayout;
</code></pre>
        </article>
    </section>






        
        <!-- disqus code -->
        <div id="disqus_thread"></div>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="//disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        <!-- // disqus code -->
        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 0.3.10</a> on Wed Feb 03 2021 17:28:40 GMT+0900 (Korean Standard Time)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/main.js"></script>
</body>
</html>
